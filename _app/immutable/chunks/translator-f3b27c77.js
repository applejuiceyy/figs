import{_ as h}from"./preload-helper-aa6bc0ce.js";import{w as d,d as j}from"./index-4c809250.js";import{l as P}from"./loading-4af838e0.js";let f=[],p="en_us";var g;{let s=localStorage.getItem("favourites");s!==null&&(f=s===""?[]:s.split(";")),p=(g=localStorage.getItem("locale"))!=null?g:"en_us"}let v=d({readerEnabled:!1,favourites:f,language:p});v.subscribe(s=>{localStorage.setItem("favourites",s.favourites.join(";")),localStorage.setItem("locale",s.language)});const b="Favourites",m="Content",_="Search",T="Preferences",c={favourites:b,"hide-table":"Hide Table","show-table":"Show Table","disable-focus":"Disable Focus","enable-focus":"Enable Focus",content:m,"global-objects":"Global Objects","misc-types":"Miscellaneous Types","misc-enums":"Miscellaneous Enums",search:_,"pick-a-version":"Pick a version","version-not-selected":"Version not selected","made-by-applejuice":"Made by applejuice","show-everything":"Show everything","show-not-everything":"Show not everything",preferences:T,"jump-to-top":"Jump to top"},O=Object.freeze(Object.defineProperty({__proto__:null,favourites:b,content:m,search:_,preferences:T,default:c},Symbol.toStringTag,{value:"Module"}));let L=Object.assign({"./figs/en_us.json":()=>h(()=>Promise.resolve().then(()=>O),void 0,import.meta.url).then(s=>s.default),"./figs/pt_pt.json":()=>h(()=>import("./pt_pt-23182b15.js"),[],import.meta.url).then(s=>s.default)}),o={en_us:c},y=Object.entries(L);y.forEach(s=>{let e=s[0].split("/"),t=e[e.length-1].split(".")[0];t in o||(o[t]=s[1])});function E(s){return s.replaceAll("u","uwu").replaceAll("d","w").replaceAll("b","w").replaceAll("g","w").replaceAll("t","w")+(Math.random()>.8?" >w<":" :3")}let S={};Object.entries(c).forEach(s=>{S[s[0]]=E(s[1])});o.en_uwu=()=>new Promise(s=>s(S));function l(s,e){return`${s}-${e}`}class V{constructor(e){this.cachedTranslations={},this.providers={},this.stores={},this.languageStore=e,this.currentLanguage="",this.activeTransfers=[],this.loadCancel=()=>{},this.languageStore.subscribe(async t=>{t!==this.currentLanguage&&(this.currentLanguage=t,this.reloadQueue(),this.updateStores())})}reloadQueue(){if(this.currentLanguage!=="en_us"){let e=Object.entries(this.providers);for(let t=0;t<e.length;t++){let r=e[t],a=l(r[0],this.currentLanguage);this.currentLanguage in r[1]&&!(a in this.cachedTranslations||this.activeTransfers.includes(a))&&this.transfer(r[0])}}}async transfer(e){let t=this.currentLanguage,r=l(e,t),a=P.request(`Fetching language with a cache id of "${r}"`);this.activeTransfers.push(r);let i,n=this.providers[e][t];if(typeof n=="function")try{i=await n()}catch(u){console.error(u),this.activeTransfers.splice(this.activeTransfers.findIndex(w=>w==r),1),a();return}else i=n;this.cachedTranslations[r]=i,this.activeTransfers.splice(this.activeTransfers.findIndex(u=>u==r),1),t===this.currentLanguage&&this.updateStores(),a()}updateStores(){let e=Object.entries(this.stores);for(let t=0;t<e.length;t++)e[t][1].set(this.getStoreValue(e[t][0]))}getStoreValue(e){let t=Object.entries(this.providers);for(let r=0;r<t.length;r++){let a=t[r],i=l(a[0],this.currentLanguage);if(i in this.cachedTranslations&&e in this.cachedTranslations[i])return{type:"RESULT",result:this.cachedTranslations[i][e]};if(i=l(a[0],"en_us"),i in this.cachedTranslations&&e in this.cachedTranslations[i])return{type:"FALLBACK",result:this.cachedTranslations[i][e]}}return this.activeTransfers.length>0?{type:"PROCESSING"}:{type:"NOTFOUND"}}getPresentableValue(e){let t=this.getStoreValue(e);return this.getPresentableValueFromResult(t,e)}getPresentableValueFromResult(e,t){return e.type==="RESULT"?e.result:t}addProvider(e,t){this.providers[t]=e;let r=l(t,"en_us");return this.cachedTranslations[r]=e.en_us,this.reloadQueue(),()=>this.removeProvider(t)}removeProvider(e){delete this.providers[e],this.reloadQueue()}createStore(e){if(e in this.stores)return this.stores[e];let t=d(this.getStoreValue(e),r=>(e in this.stores||(this.stores[e]=t,r(this.getStoreValue(e))),()=>{delete this.stores[e]}));return this.stores[e]=t,t}getProviderStatistics(){let e={providers:Object.keys(this.providers),languages:{}},t=Object.entries(this.providers);for(let r=0;r<t.length;r++){let a=t[r],i=Object.keys(a[1]);for(let n=0;n<i.length;n++)i[n]in e.languages||(e.languages[i[n]]=[]),e.languages[i[n]].push(a[0])}return e}}let I=new V(j(v,s=>s.language));I.addProvider(o,"figs");export{I as p,v as w};
